stages:
  - prepare_tf   # [Terraform] pipeline
  - validate_tf
  - plan_tf
  - deploy_tf
  - destroy_tf
  - configure_infra # [Ansible] job
  - upload_to_dockerhub    # [DinD] job
  # - push_to_remote   # [Ansible] job

include:
  - local: '/_cicd/deploy_infrastructure.yml'
  - local: '/_cicd/configure_infrastructure.yml'
  - local: '/_cicd/deploy_app.yml'